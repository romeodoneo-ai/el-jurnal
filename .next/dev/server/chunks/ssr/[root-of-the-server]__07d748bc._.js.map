{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/PC/Downloads/el-jurnal/src/lib/config.ts"],"sourcesContent":["import { Student } from './types';\n\nexport const GROUP_NAME = 'СИС-12';\nexport const CURATOR = 'Сергей Павлович Мантуленко';\n\nexport const STUDENTS: Student[] = [\n  { id: 1, name: 'Бреславский Леонид' },\n  { id: 2, name: 'Бугай Дмитрий' },\n  { id: 3, name: 'Быкадоров Николай' },\n  { id: 4, name: 'Галоян Валерий' },\n  { id: 5, name: 'Дудник Ярослав' },\n  { id: 6, name: 'Ефимов Даниил' },\n  { id: 7, name: 'Жуков Кирилл' },\n  { id: 8, name: 'Козлов Артем' },\n  { id: 9, name: 'Комилов Амирхан' },\n  { id: 10, name: 'Литвинов Максим' },\n  { id: 11, name: 'Лобачевский Вадим' },\n  { id: 12, name: 'Луганский Семён' },\n  { id: 13, name: 'Молчанов Дмитрий' },\n  { id: 14, name: 'Нужный Роман' },\n  { id: 15, name: 'Остроух Ярослав' },\n  { id: 16, name: 'Подрезов Сергей' },\n  { id: 17, name: 'Пыжов Илья' },\n  { id: 18, name: 'Расулов Амин' },\n  { id: 19, name: 'Селявка Александр' },\n  { id: 20, name: 'Тен Владимир' },\n  { id: 21, name: 'Фоменко Дмитрий' },\n  { id: 22, name: 'Шабалин Артём' },\n  { id: 23, name: 'Шарифов Тимур' },\n  { id: 24, name: 'Шкабарня Александра' },\n];\n\nexport const SUBJECTS = [\n  'Математика',\n  'Физика',\n  'Литература',\n  'Русский',\n  'История',\n  'Химия',\n  'Информатика',\n  'Иностранный',\n] as const;\n\nexport type Subject = (typeof SUBJECTS)[number];\n\n// Hours per pair (each pair = 2 academic hours)\nexport const HOURS_PER_PAIR = 2;\n"],"names":[],"mappings":";;;;;;;;;;;;AAEO,MAAM,aAAa;AACnB,MAAM,UAAU;AAEhB,MAAM,WAAsB;IACjC;QAAE,IAAI;QAAG,MAAM;IAAqB;IACpC;QAAE,IAAI;QAAG,MAAM;IAAgB;IAC/B;QAAE,IAAI;QAAG,MAAM;IAAoB;IACnC;QAAE,IAAI;QAAG,MAAM;IAAiB;IAChC;QAAE,IAAI;QAAG,MAAM;IAAiB;IAChC;QAAE,IAAI;QAAG,MAAM;IAAgB;IAC/B;QAAE,IAAI;QAAG,MAAM;IAAe;IAC9B;QAAE,IAAI;QAAG,MAAM;IAAe;IAC9B;QAAE,IAAI;QAAG,MAAM;IAAkB;IACjC;QAAE,IAAI;QAAI,MAAM;IAAkB;IAClC;QAAE,IAAI;QAAI,MAAM;IAAoB;IACpC;QAAE,IAAI;QAAI,MAAM;IAAkB;IAClC;QAAE,IAAI;QAAI,MAAM;IAAmB;IACnC;QAAE,IAAI;QAAI,MAAM;IAAe;IAC/B;QAAE,IAAI;QAAI,MAAM;IAAkB;IAClC;QAAE,IAAI;QAAI,MAAM;IAAkB;IAClC;QAAE,IAAI;QAAI,MAAM;IAAa;IAC7B;QAAE,IAAI;QAAI,MAAM;IAAe;IAC/B;QAAE,IAAI;QAAI,MAAM;IAAoB;IACpC;QAAE,IAAI;QAAI,MAAM;IAAe;IAC/B;QAAE,IAAI;QAAI,MAAM;IAAkB;IAClC;QAAE,IAAI;QAAI,MAAM;IAAgB;IAChC;QAAE,IAAI;QAAI,MAAM;IAAgB;IAChC;QAAE,IAAI;QAAI,MAAM;IAAsB;CACvC;AAEM,MAAM,WAAW;IACtB;IACA;IACA;IACA;IACA;IACA;IACA;IACA;CACD;AAKM,MAAM,iBAAiB"}},
    {"offset": {"line": 137, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/PC/Downloads/el-jurnal/src/lib/storage.ts"],"sourcesContent":["import { AttendanceStatus, DayAttendance, PairAttendance, MonthReport, ReportRow } from './types';\nimport { STUDENTS, SUBJECTS, HOURS_PER_PAIR, GROUP_NAME, CURATOR } from './config';\n\nconst STORAGE_KEY = 'el-jurnal-attendance';\n\n// --- localStorage helpers ---\n\nfunction getAllData(): Record<string, DayAttendance> {\n  if (typeof window === 'undefined') return {};\n  try {\n    const raw = localStorage.getItem(STORAGE_KEY);\n    return raw ? JSON.parse(raw) : {};\n  } catch {\n    return {};\n  }\n}\n\nfunction saveAllData(data: Record<string, DayAttendance>) {\n  if (typeof window === 'undefined') return;\n  localStorage.setItem(STORAGE_KEY, JSON.stringify(data));\n}\n\n// --- Public API ---\n\nexport function getDayAttendance(date: string): DayAttendance | null {\n  const data = getAllData();\n  return data[date] || null;\n}\n\nexport function saveDayAttendance(day: DayAttendance) {\n  const data = getAllData();\n  data[day.date] = day;\n  saveAllData(data);\n}\n\nexport function getFilledDates(): string[] {\n  const data = getAllData();\n  return Object.keys(data).sort();\n}\n\nexport function getMonthDates(year: number, month: number): string[] {\n  const data = getAllData();\n  const prefix = `${year}-${String(month).padStart(2, '0')}`;\n  return Object.keys(data)\n    .filter((d) => d.startsWith(prefix))\n    .sort();\n}\n\n// --- Report generation ---\n\nexport function generateMonthReport(year: number, month: number): MonthReport {\n  const dates = getMonthDates(year, month);\n  const data = getAllData();\n\n  // Count hours per subject in this month\n  const subjectHours: Record<string, number> = {};\n  SUBJECTS.forEach((s) => (subjectHours[s] = 0));\n\n  // Count absences per student per subject\n  const absences: Record<number, Record<string, { total: number; excused: number }>> = {};\n  STUDENTS.forEach((st) => {\n    absences[st.id] = {};\n    SUBJECTS.forEach((s) => {\n      absences[st.id][s] = { total: 0, excused: 0 };\n    });\n  });\n\n  for (const date of dates) {\n    const day = data[date];\n    if (!day) continue;\n\n    for (const pair of day.pairs) {\n      if (!pair.subject) continue;\n      subjectHours[pair.subject] = (subjectHours[pair.subject] || 0) + HOURS_PER_PAIR;\n\n      for (const student of STUDENTS) {\n        const status = pair.attendance[student.id] || '';\n        if (status === 'Н' || status === 'У') {\n          absences[student.id][pair.subject].total += HOURS_PER_PAIR;\n          if (status === 'У') {\n            absences[student.id][pair.subject].excused += HOURS_PER_PAIR;\n          }\n        }\n      }\n    }\n  }\n\n  const totalHours = Object.values(subjectHours).reduce((a, b) => a + b, 0);\n\n  const rows: ReportRow[] = STUDENTS.map((student) => {\n    const bySubject: Record<string, number> = {};\n    let total = 0;\n    let excused = 0;\n\n    SUBJECTS.forEach((s) => {\n      const missed = absences[student.id][s].total;\n      bySubject[s] = missed;\n      total += missed;\n      excused += absences[student.id][s].excused;\n    });\n\n    const totalPercent = totalHours > 0 ? `${Math.round((total / totalHours) * 100)}%` : '0%';\n    const unexcusedPercent =\n      totalHours > 0 ? `${Math.round(((total - excused) / totalHours) * 100)}%` : '0%';\n\n    return {\n      studentId: student.id,\n      studentName: student.name,\n      bySubject,\n      total,\n      excused,\n      totalPercent,\n      unexcusedPercent,\n    };\n  });\n\n  const monthNames = [\n    '', 'январь', 'февраль', 'март', 'апрель', 'май', 'июнь',\n    'июль', 'август', 'сентябрь', 'октябрь', 'ноябрь', 'декабрь',\n  ];\n\n  return {\n    month: monthNames[month],\n    year: `${year}-${year + 1}`,\n    group: GROUP_NAME,\n    curator: CURATOR,\n    subjects: [...SUBJECTS],\n    subjectHours,\n    totalHours,\n    rows,\n  };\n}\n\n// --- Export to CSV ---\n\nexport function exportReportCSV(report: MonthReport): string {\n  const header = [\n    '№',\n    'ФИО студента',\n    ...report.subjects,\n    'ИТОГО',\n    'Из них по уважит.',\n    '% пропусков',\n    '% неуважит. проп.',\n  ];\n\n  const hoursRow = ['', 'Кол. часов', ...report.subjects.map((s) => String(report.subjectHours[s])), String(report.totalHours), '', '', ''];\n\n  const dataRows = report.rows.map((row, i) => [\n    String(i + 1),\n    row.studentName,\n    ...report.subjects.map((s) => String(row.bySubject[s] || '')),\n    String(row.total),\n    String(row.excused),\n    row.totalPercent,\n    row.unexcusedPercent,\n  ]);\n\n  return [header, hoursRow, ...dataRows].map((row) => row.join(',')).join('\\n');\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 306, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/PC/Downloads/el-jurnal/src/lib/sync.ts"],"sourcesContent":["import { DayAttendance } from './types';\n\nconst SETTINGS_KEY = 'el-jurnal-settings';\n\ninterface SyncSettings {\n  scriptUrl: string;\n  pin: string;\n}\n\nexport function getSyncSettings(): SyncSettings | null {\n  if (typeof window === 'undefined') return null;\n  try {\n    const raw = localStorage.getItem(SETTINGS_KEY);\n    return raw ? JSON.parse(raw) : null;\n  } catch {\n    return null;\n  }\n}\n\nexport function saveSyncSettings(settings: SyncSettings) {\n  if (typeof window === 'undefined') return;\n  localStorage.setItem(SETTINGS_KEY, JSON.stringify(settings));\n}\n\nexport async function syncToSheets(day: DayAttendance): Promise<{ success: boolean; message: string }> {\n  const settings = getSyncSettings();\n  if (!settings?.scriptUrl) {\n    return { success: false, message: 'Не настроена синхронизация' };\n  }\n\n  try {\n    const url = `${settings.scriptUrl}?action=saveAttendance&pin=${encodeURIComponent(settings.pin)}`;\n    const response = await fetch(url, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify(day),\n      mode: 'no-cors',\n    });\n\n    // Google Apps Script с no-cors возвращает opaque response\n    // Используем redirect-based approach\n    return { success: true, message: 'Отправлено в Google Sheets' };\n  } catch (err) {\n    return { success: false, message: `Ошибка: ${err}` };\n  }\n}\n\nexport async function syncSaveAttendance(day: DayAttendance): Promise<{ success: boolean; message: string }> {\n  const settings = getSyncSettings();\n  if (!settings?.scriptUrl) {\n    return { success: false, message: 'Синхронизация не настроена' };\n  }\n\n  try {\n    // Google Apps Script web apps need a special approach for POST\n    // We use a form-based approach that works with CORS\n    const formData = new URLSearchParams();\n    formData.append('action', 'saveAttendance');\n    formData.append('pin', settings.pin);\n    formData.append('data', JSON.stringify(day));\n\n    const response = await fetch(settings.scriptUrl, {\n      method: 'POST',\n      body: formData,\n      redirect: 'follow',\n    });\n\n    if (response.ok) {\n      const result = await response.json();\n      return { success: true, message: result.message || 'Сохранено в Google Sheets' };\n    }\n\n    return { success: true, message: 'Данные отправлены' };\n  } catch {\n    // With Google Apps Script, even \"failed\" requests often succeed\n    return { success: true, message: 'Данные отправлены в Google Sheets' };\n  }\n}\n"],"names":[],"mappings":";;;;;;;;;;AAEA,MAAM,eAAe;AAOd,SAAS;IACd,wCAAmC,OAAO;;;AAO5C;AAEO,SAAS,iBAAiB,QAAsB;IACrD,wCAAmC;;;AAErC;AAEO,eAAe,aAAa,GAAkB;IACnD,MAAM,WAAW;IACjB,IAAI,CAAC,UAAU,WAAW;QACxB,OAAO;YAAE,SAAS;YAAO,SAAS;QAA6B;IACjE;IAEA,IAAI;QACF,MAAM,MAAM,GAAG,SAAS,SAAS,CAAC,2BAA2B,EAAE,mBAAmB,SAAS,GAAG,GAAG;QACjG,MAAM,WAAW,MAAM,MAAM,KAAK;YAChC,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;YACrB,MAAM;QACR;QAEA,0DAA0D;QAC1D,qCAAqC;QACrC,OAAO;YAAE,SAAS;YAAM,SAAS;QAA6B;IAChE,EAAE,OAAO,KAAK;QACZ,OAAO;YAAE,SAAS;YAAO,SAAS,CAAC,QAAQ,EAAE,KAAK;QAAC;IACrD;AACF;AAEO,eAAe,mBAAmB,GAAkB;IACzD,MAAM,WAAW;IACjB,IAAI,CAAC,UAAU,WAAW;QACxB,OAAO;YAAE,SAAS;YAAO,SAAS;QAA6B;IACjE;IAEA,IAAI;QACF,+DAA+D;QAC/D,oDAAoD;QACpD,MAAM,WAAW,IAAI;QACrB,SAAS,MAAM,CAAC,UAAU;QAC1B,SAAS,MAAM,CAAC,OAAO,SAAS,GAAG;QACnC,SAAS,MAAM,CAAC,QAAQ,KAAK,SAAS,CAAC;QAEvC,MAAM,WAAW,MAAM,MAAM,SAAS,SAAS,EAAE;YAC/C,QAAQ;YACR,MAAM;YACN,UAAU;QACZ;QAEA,IAAI,SAAS,EAAE,EAAE;YACf,MAAM,SAAS,MAAM,SAAS,IAAI;YAClC,OAAO;gBAAE,SAAS;gBAAM,SAAS,OAAO,OAAO,IAAI;YAA4B;QACjF;QAEA,OAAO;YAAE,SAAS;YAAM,SAAS;QAAoB;IACvD,EAAE,OAAM;QACN,gEAAgE;QAChE,OAAO;YAAE,SAAS;YAAM,SAAS;QAAoC;IACvE;AACF"}},
    {"offset": {"line": 401, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/PC/Downloads/el-jurnal/src/app/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect, useCallback } from 'react';\nimport { STUDENTS, SUBJECTS } from '@/lib/config';\nimport { getDayAttendance, saveDayAttendance } from '@/lib/storage';\nimport { AttendanceStatus, DayAttendance, PairAttendance } from '@/lib/types';\nimport { syncSaveAttendance, getSyncSettings } from '@/lib/sync';\nimport Link from 'next/link';\n\nfunction formatDate(dateStr: string): string {\n  const d = new Date(dateStr + 'T00:00:00');\n  const days = ['Вс', 'Пн', 'Вт', 'Ср', 'Чт', 'Пт', 'Сб'];\n  const months = ['янв', 'фев', 'мар', 'апр', 'май', 'июн', 'июл', 'авг', 'сен', 'окт', 'ноя', 'дек'];\n  return `${days[d.getDay()]}, ${d.getDate()} ${months[d.getMonth()]}`;\n}\n\nfunction todayStr(): string {\n  const d = new Date();\n  return `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, '0')}-${String(d.getDate()).padStart(2, '0')}`;\n}\n\nfunction createEmptyPairs(count: number): PairAttendance[] {\n  return Array.from({ length: count }, (_, i) => ({\n    pairNumber: i + 1,\n    subject: '',\n    attendance: {},\n  }));\n}\n\nfunction StatusBadge({ status, onClick }: { status: AttendanceStatus; onClick: () => void }) {\n  if (status === 'Н') {\n    return (\n      <button\n        onClick={onClick}\n        className=\"w-12 h-12 rounded-xl bg-red-500 text-white font-bold text-lg flex items-center justify-center active:scale-95 transition-transform shadow-sm\"\n      >\n        Н\n      </button>\n    );\n  }\n  if (status === 'У') {\n    return (\n      <button\n        onClick={onClick}\n        className=\"w-12 h-12 rounded-xl bg-amber-400 text-white font-bold text-lg flex items-center justify-center active:scale-95 transition-transform shadow-sm\"\n      >\n        У\n      </button>\n    );\n  }\n  return (\n    <button\n      onClick={onClick}\n      className=\"w-12 h-12 rounded-xl bg-emerald-100 text-emerald-600 font-bold text-lg flex items-center justify-center active:scale-95 transition-transform border border-emerald-200\"\n    >\n      +\n    </button>\n  );\n}\n\nexport default function Home() {\n  const [date, setDate] = useState(todayStr());\n  const [pairCount, setPairCount] = useState(4);\n  const [pairs, setPairs] = useState<PairAttendance[]>(createEmptyPairs(4));\n  const [activePair, setActivePair] = useState(0);\n  const [saved, setSaved] = useState(false);\n  const [loaded, setLoaded] = useState(false);\n\n  useEffect(() => {\n    const existing = getDayAttendance(date);\n    if (existing) {\n      setPairs(existing.pairs);\n      setPairCount(existing.pairs.length);\n    } else {\n      setPairs(createEmptyPairs(4));\n      setPairCount(4);\n    }\n    setActivePair(0);\n    setSaved(false);\n    setLoaded(true);\n  }, [date]);\n\n  const toggleStatus = useCallback((studentId: number) => {\n    setPairs((prev) => {\n      const next = [...prev];\n      const pair = { ...next[activePair] };\n      const newAtt = { ...pair.attendance };\n      const current = newAtt[studentId] || '';\n\n      if (current === '') newAtt[studentId] = 'Н';\n      else if (current === 'Н') newAtt[studentId] = 'У';\n      else delete newAtt[studentId];\n\n      pair.attendance = newAtt;\n      next[activePair] = pair;\n      return next;\n    });\n    setSaved(false);\n  }, [activePair]);\n\n  const setSubject = useCallback((subject: string) => {\n    setPairs((prev) => {\n      const next = [...prev];\n      next[activePair] = { ...next[activePair], subject };\n      return next;\n    });\n    setSaved(false);\n  }, [activePair]);\n\n  const [syncing, setSyncing] = useState(false);\n  const [syncMsg, setSyncMsg] = useState('');\n\n  const handleSave = useCallback(async () => {\n    const day: DayAttendance = {\n      date,\n      pairs: pairs.slice(0, pairCount),\n    };\n    saveDayAttendance(day);\n    setSaved(true);\n\n    // Sync to Google Sheets if configured\n    const settings = getSyncSettings();\n    if (settings?.scriptUrl) {\n      setSyncing(true);\n      const result = await syncSaveAttendance(day);\n      setSyncMsg(result.message);\n      setSyncing(false);\n      setTimeout(() => setSyncMsg(''), 3000);\n    }\n\n    setTimeout(() => setSaved(false), 2000);\n  }, [date, pairs, pairCount]);\n\n  const markAllPresent = useCallback(() => {\n    setPairs((prev) => {\n      const next = [...prev];\n      next[activePair] = { ...next[activePair], attendance: {} };\n      return next;\n    });\n    setSaved(false);\n  }, [activePair]);\n\n  const absentCount = Object.values(pairs[activePair]?.attendance || {}).filter(Boolean).length;\n\n  if (!loaded) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"text-gray-400 text-lg\">Загрузка...</div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"max-w-lg mx-auto pb-24\">\n      {/* Header */}\n      <header className=\"bg-blue-500 text-white px-4 py-3 sticky top-0 z-50 shadow-md\">\n        <div className=\"flex items-center justify-between\">\n          <Link href=\"/settings\" className=\"text-sm bg-white/20 w-8 h-8 rounded-lg flex items-center justify-center\">\n            <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\"><path d=\"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z\"/><circle cx=\"12\" cy=\"12\" r=\"3\"/></svg>\n          </Link>\n          <h1 className=\"text-lg font-bold\">Журнал СИС-12</h1>\n          <Link\n            href=\"/report\"\n            className=\"text-sm bg-white/20 px-3 py-1.5 rounded-lg hover:bg-white/30 transition-colors\"\n          >\n            Отчёт\n          </Link>\n        </div>\n      </header>\n\n      {/* Date picker */}\n      <div className=\"px-4 py-3 bg-white border-b border-gray-100\">\n        <div className=\"flex items-center gap-3\">\n          <input\n            type=\"date\"\n            value={date}\n            onChange={(e) => setDate(e.target.value)}\n            className=\"flex-1 border border-gray-200 rounded-xl px-4 py-2.5 text-base bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-300\"\n          />\n          <span className=\"text-sm text-gray-500 font-medium min-w-[80px] text-right\">\n            {formatDate(date)}\n          </span>\n        </div>\n      </div>\n\n      {/* Pair tabs */}\n      <div className=\"px-4 py-2 bg-white border-b border-gray-100\">\n        <div className=\"flex gap-2\">\n          {Array.from({ length: pairCount }, (_, i) => {\n            const pairAbsent = Object.values(pairs[i]?.attendance || {}).filter(Boolean).length;\n            return (\n              <button\n                key={i}\n                onClick={() => setActivePair(i)}\n                className={`flex-1 py-2 rounded-xl text-sm font-medium transition-all relative ${\n                  activePair === i\n                    ? 'bg-blue-500 text-white shadow-md'\n                    : 'bg-gray-100 text-gray-600'\n                }`}\n              >\n                Пара {i + 1}\n                {pairAbsent > 0 && (\n                  <span className={`absolute -top-1.5 -right-1 min-w-5 h-5 px-1 rounded-full text-xs flex items-center justify-center font-bold ${\n                    activePair === i ? 'bg-red-500 text-white' : 'bg-red-100 text-red-600'\n                  }`}>\n                    {pairAbsent}\n                  </span>\n                )}\n              </button>\n            );\n          })}\n        </div>\n        <div className=\"flex items-center gap-2 mt-2\">\n          <span className=\"text-xs text-gray-400\">Кол-во пар:</span>\n          {[2, 3, 4].map((n) => (\n            <button\n              key={n}\n              onClick={() => {\n                setPairCount(n);\n                if (activePair >= n) setActivePair(n - 1);\n                setPairs((prev) => {\n                  if (prev.length >= n) return prev;\n                  return [...prev, ...createEmptyPairs(n - prev.length)];\n                });\n              }}\n              className={`w-8 h-7 rounded-lg text-xs font-medium ${\n                pairCount === n\n                  ? 'bg-blue-100 text-blue-700 border border-blue-300'\n                  : 'bg-gray-50 text-gray-400 border border-gray-200'\n              }`}\n            >\n              {n}\n            </button>\n          ))}\n        </div>\n      </div>\n\n      {/* Subject selector */}\n      <div className=\"px-4 py-2 bg-white border-b border-gray-100\">\n        <select\n          value={pairs[activePair]?.subject || ''}\n          onChange={(e) => setSubject(e.target.value)}\n          className=\"w-full border border-gray-200 rounded-xl px-4 py-2.5 text-base bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-300\"\n        >\n          <option value=\"\">-- Предмет --</option>\n          {SUBJECTS.map((s) => (\n            <option key={s} value={s}>{s}</option>\n          ))}\n        </select>\n      </div>\n\n      {/* Info bar */}\n      <div className=\"px-4 py-2 bg-gray-50 flex items-center justify-between border-b border-gray-100\">\n        <span className=\"text-xs text-gray-500\">\n          Нет: <span className=\"font-bold text-gray-700\">{absentCount}</span> / {STUDENTS.length}\n        </span>\n        {absentCount > 0 && (\n          <button onClick={markAllPresent} className=\"text-xs text-blue-500 font-medium\">\n            Сбросить\n          </button>\n        )}\n      </div>\n\n      {/* Legend */}\n      <div className=\"px-4 py-1.5 bg-gray-50 flex gap-4 text-xs text-gray-400 border-b border-gray-100\">\n        <span className=\"flex items-center gap-1\">\n          <span className=\"w-3 h-3 rounded bg-emerald-100 border border-emerald-200 inline-block\" /> Есть\n        </span>\n        <span className=\"flex items-center gap-1\">\n          <span className=\"w-3 h-3 rounded bg-red-500 inline-block\" /> Н\n        </span>\n        <span className=\"flex items-center gap-1\">\n          <span className=\"w-3 h-3 rounded bg-amber-400 inline-block\" /> У\n        </span>\n      </div>\n\n      {/* Student list */}\n      <div className=\"divide-y divide-gray-100\">\n        {STUDENTS.map((student) => {\n          const status = (pairs[activePair]?.attendance[student.id] || '') as AttendanceStatus;\n          return (\n            <div\n              key={student.id}\n              className={`flex items-center px-4 py-2.5 gap-3 transition-colors ${\n                status === 'Н' ? 'bg-red-50' : status === 'У' ? 'bg-amber-50' : 'bg-white'\n              }`}\n            >\n              <span className=\"text-xs text-gray-400 w-5 text-right shrink-0\">{student.id}</span>\n              <span className=\"flex-1 text-sm font-medium truncate\">{student.name}</span>\n              <StatusBadge status={status} onClick={() => toggleStatus(student.id)} />\n            </div>\n          );\n        })}\n      </div>\n\n      {/* Save button */}\n      <div className=\"fixed bottom-0 left-0 right-0 p-4 bg-white/90 backdrop-blur-sm border-t shadow-lg z-50\">\n        <div className=\"max-w-lg mx-auto\">\n          {syncMsg && (\n            <p className=\"text-xs text-center text-gray-500 mb-1\">{syncMsg}</p>\n          )}\n          <button\n            onClick={handleSave}\n            disabled={syncing}\n            className={`w-full py-3.5 rounded-2xl font-bold text-lg transition-all active:scale-[0.98] shadow-md ${\n              saved\n                ? 'bg-emerald-500 text-white'\n                : syncing\n                ? 'bg-gray-400 text-white'\n                : 'bg-blue-500 text-white'\n            }`}\n          >\n            {syncing ? 'Синхронизация...' : saved ? 'Сохранено!' : 'Сохранить'}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}