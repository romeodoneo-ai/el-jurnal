module.exports=[18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},42602,(a,b,c)=>{"use strict";b.exports=a.r(18622)},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},72131,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].React},9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},38783,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactServerDOMTurbopackClient},76808,2759,a=>{"use strict";let b="СИС-12",c="Сергей Павлович Мантуленко",d=[{id:1,name:"Бреславский Леонид"},{id:2,name:"Бугай Дмитрий"},{id:3,name:"Быкадоров Николай"},{id:4,name:"Галоян Валерий"},{id:5,name:"Дудник Ярослав"},{id:6,name:"Ефимов Даниил"},{id:7,name:"Жуков Кирилл"},{id:8,name:"Козлов Артем"},{id:9,name:"Комилов Амирхан"},{id:10,name:"Литвинов Максим"},{id:11,name:"Лобачевский Вадим"},{id:12,name:"Луганский Семён"},{id:13,name:"Молчанов Дмитрий"},{id:14,name:"Нужный Роман"},{id:15,name:"Остроух Ярослав"},{id:16,name:"Подрезов Сергей"},{id:17,name:"Пыжов Илья"},{id:18,name:"Расулов Амин"},{id:19,name:"Селявка Александр"},{id:20,name:"Тен Владимир"},{id:21,name:"Фоменко Дмитрий"},{id:22,name:"Шабалин Артём"},{id:23,name:"Шарифов Тимур"},{id:24,name:"Шкабарня Александра"}],e=["Математика","Физика","Литература","Русский","История","Химия","Информатика","Иностранный"];function f(a){return({})[a]||null}function g(a){}function h(){return[].sort()}function i(a,f){let g,h=(g=`${a}-${String(f).padStart(2,"0")}`,[].filter(a=>a.startsWith(g)).sort()),i={},j={};e.forEach(a=>j[a]=0);let k={};for(let a of(d.forEach(a=>{k[a.id]={},e.forEach(b=>{k[a.id][b]={total:0,excused:0}})}),h)){let b=i[a];if(b){for(let a of b.pairs)if(a.subject)for(let b of(j[a.subject]=(j[a.subject]||0)+2,d)){let c=a.attendance[b.id]||"";("Н"===c||"У"===c)&&(k[b.id][a.subject].total+=2,"У"===c&&(k[b.id][a.subject].excused+=2))}}}let l=Object.values(j).reduce((a,b)=>a+b,0),m=d.map(a=>{let b={},c=0,d=0;e.forEach(e=>{let f=k[a.id][e].total;b[e]=f,c+=f,d+=k[a.id][e].excused});let f=l>0?`${Math.round(c/l*100)}%`:"0%",g=l>0?`${Math.round((c-d)/l*100)}%`:"0%";return{studentId:a.id,studentName:a.name,bySubject:b,total:c,excused:d,totalPercent:f,unexcusedPercent:g}});return{month:["","январь","февраль","март","апрель","май","июнь","июль","август","сентябрь","октябрь","ноябрь","декабрь"][f],year:`${a}-${a+1}`,group:b,curator:c,subjects:[...e],subjectHours:j,totalHours:l,rows:m}}function j(a){return[["№","ФИО студента",...a.subjects,"ИТОГО","Из них по уважит.","% пропусков","% неуважит. проп."],["","Кол. часов",...a.subjects.map(b=>String(a.subjectHours[b])),String(a.totalHours),"","",""],...a.rows.map((b,c)=>[String(c+1),b.studentName,...a.subjects.map(a=>String(b.bySubject[a]||"")),String(b.total),String(b.excused),b.totalPercent,b.unexcusedPercent])].map(a=>a.join(",")).join("\n")}a.s(["CURATOR",0,c,"GROUP_NAME",0,b,"HOURS_PER_PAIR",0,2,"STUDENTS",0,d,"SUBJECTS",0,e],2759),a.s(["exportReportCSV",()=>j,"generateMonthReport",()=>i,"getDayAttendance",()=>f,"getFilledDates",()=>h,"saveDayAttendance",()=>g],76808)},33435,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(76808),e=a.i(2759),f=a.i(38246);let g=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"];function h(){let a=new Date,[h,i]=(0,c.useState)(a.getFullYear()),[j,k]=(0,c.useState)(a.getMonth()+1),[l,m]=(0,c.useState)(null),[n,o]=(0,c.useState)([]);if((0,c.useEffect)(()=>{o([...new Set((0,d.getFilledDates)().map(a=>a.slice(0,7)))])},[]),(0,c.useEffect)(()=>{m((0,d.generateMonthReport)(h,j))},[h,j]),!l)return(0,b.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,b.jsx)("div",{className:"text-gray-400",children:"Загрузка..."})});let p=l.rows.some(a=>a.total>0);return(0,b.jsxs)("div",{className:"max-w-4xl mx-auto pb-8",children:[(0,b.jsx)("header",{className:"bg-blue-500 text-white px-4 py-3 sticky top-0 z-50 shadow-md",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(f.default,{href:"/",className:"text-sm bg-white/20 px-3 py-1.5 rounded-lg",children:"← Журнал"}),(0,b.jsx)("h1",{className:"text-lg font-bold",children:"Отчёт"}),(0,b.jsx)("button",{onClick:()=>{if(!l)return;let a=new Blob(["\uFEFF"+(0,d.exportReportCSV)(l)],{type:"text/csv;charset=utf-8;"}),b=URL.createObjectURL(a),c=document.createElement("a");c.href=b,c.download=`otchet-${l.group}-${String(j).padStart(2,"0")}.${h}.csv`,c.click(),URL.revokeObjectURL(b)},className:"text-sm bg-white/20 px-3 py-1.5 rounded-lg",children:"CSV"})]})}),(0,b.jsxs)("div",{className:"px-4 py-3 bg-white border-b border-gray-100",children:[(0,b.jsx)("div",{className:"flex gap-2 overflow-x-auto pb-1",children:g.map((a,c)=>{let d=c+1,e=`${h}-${String(d).padStart(2,"0")}`,f=n.includes(e);return(0,b.jsx)("button",{onClick:()=>k(d),className:`px-3 py-1.5 rounded-lg text-sm whitespace-nowrap shrink-0 ${j===d?"bg-blue-500 text-white font-medium":f?"bg-blue-50 text-blue-700":"bg-gray-100 text-gray-400"}`,children:a.slice(0,3)},d)})}),(0,b.jsx)("div",{className:"flex gap-2 mt-2",children:[2024,2025,2026].map(a=>(0,b.jsx)("button",{onClick:()=>i(a),className:`px-3 py-1 rounded-lg text-sm ${h===a?"bg-blue-100 text-blue-700 font-medium":"bg-gray-50 text-gray-400"}`,children:a},a))})]}),(0,b.jsxs)("div",{className:"px-4 py-3 bg-white border-b border-gray-100 text-center",children:[(0,b.jsxs)("h2",{className:"text-sm font-bold text-gray-700",children:["Анализ посещаемости группы ",l.group]}),(0,b.jsxs)("p",{className:"text-xs text-gray-400 mt-0.5",children:["за ",l.month," ",h," г. | Куратор: ",l.curator]}),(0,b.jsxs)("p",{className:"text-xs text-gray-400",children:["Всего часов: ",l.totalHours]})]}),p?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"px-4 py-2 bg-gray-50 border-b border-gray-100",children:(0,b.jsx)("div",{className:"flex gap-1 overflow-x-auto text-xs",children:e.SUBJECTS.map(a=>(0,b.jsxs)("div",{className:"text-center shrink-0 min-w-[48px]",children:[(0,b.jsx)("div",{className:"text-gray-400 truncate",children:a.slice(0,4)}),(0,b.jsxs)("div",{className:"font-bold text-gray-600",children:[l.subjectHours[a],"ч"]})]},a))})}),(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full text-xs",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"bg-gray-50 border-b border-gray-200",children:[(0,b.jsx)("th",{className:"px-2 py-2 text-left sticky left-0 bg-gray-50 z-10 min-w-[140px]",children:"ФИО"}),e.SUBJECTS.map(a=>(0,b.jsx)("th",{className:"px-1.5 py-2 text-center min-w-[36px]",children:(0,b.jsx)("span",{className:"writing-mode-vertical",title:a,children:a.slice(0,3)})},a)),(0,b.jsx)("th",{className:"px-1.5 py-2 text-center font-bold",children:"Ит."}),(0,b.jsx)("th",{className:"px-1.5 py-2 text-center",children:"Ув."}),(0,b.jsx)("th",{className:"px-1.5 py-2 text-center",children:"%"}),(0,b.jsx)("th",{className:"px-1.5 py-2 text-center",children:"%Н"})]})}),(0,b.jsx)("tbody",{children:l.rows.map((a,c)=>{if(!a.studentName)return null;let d=a.total>0;return(0,b.jsxs)("tr",{className:`border-b border-gray-100 ${d?"":"text-gray-300"}`,children:[(0,b.jsxs)("td",{className:"px-2 py-2 sticky left-0 bg-white z-10 font-medium truncate max-w-[140px]",children:[(0,b.jsxs)("span",{className:"text-gray-400 mr-1",children:[c+1,"."]}),a.studentName]}),e.SUBJECTS.map(c=>(0,b.jsx)("td",{className:`px-1.5 py-2 text-center ${a.bySubject[c]>0?"text-red-600 font-medium":"text-gray-300"}`,children:a.bySubject[c]||""},c)),(0,b.jsx)("td",{className:`px-1.5 py-2 text-center font-bold ${a.total>0?"text-red-600":"text-gray-300"}`,children:a.total||""}),(0,b.jsx)("td",{className:"px-1.5 py-2 text-center text-amber-600",children:a.excused||""}),(0,b.jsx)("td",{className:`px-1.5 py-2 text-center ${parseInt(a.totalPercent)>30?"text-red-600 font-bold":""}`,children:a.total>0?a.totalPercent:""}),(0,b.jsx)("td",{className:`px-1.5 py-2 text-center ${parseInt(a.unexcusedPercent)>20?"text-red-600 font-bold":""}`,children:a.total>0?a.unexcusedPercent:""})]},a.studentId)})})]})})]}):(0,b.jsxs)("div",{className:"px-4 py-16 text-center text-gray-400",children:[(0,b.jsx)("p",{className:"text-lg mb-2",children:"Нет данных"}),(0,b.jsxs)("p",{className:"text-sm",children:["Заполните посещаемость за ",g[j-1].toLowerCase()]})]})]})}a.s(["default",()=>h])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__22c461d1._.js.map