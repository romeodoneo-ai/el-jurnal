module.exports=[18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},42602,(a,b,c)=>{"use strict";b.exports=a.r(18622)},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},72131,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].React},9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},38783,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactServerDOMTurbopackClient},71106,a=>{"use strict";function b(){return null}function c(a){}async function d(a){let c=b();if(!c?.scriptUrl)return{success:!1,message:"Синхронизация не настроена"};try{let b=new URLSearchParams;b.append("action","saveAttendance"),b.append("pin",c.pin),b.append("data",JSON.stringify(a));let d=await fetch(c.scriptUrl,{method:"POST",body:b,redirect:"follow"});if(d.ok){let a=await d.json();return{success:!0,message:a.message||"Сохранено в Google Sheets"}}return{success:!0,message:"Данные отправлены"}}catch{return{success:!0,message:"Данные отправлены в Google Sheets"}}}a.s(["getSyncSettings",()=>b,"saveSyncSettings",()=>c,"syncSaveAttendance",()=>d])},76808,2759,a=>{"use strict";let b="СИС-12",c="Сергей Павлович Мантуленко",d=[{id:1,name:"Бреславский Леонид"},{id:2,name:"Бугай Дмитрий"},{id:3,name:"Быкадоров Николай"},{id:4,name:"Галоян Валерий"},{id:5,name:"Дудник Ярослав"},{id:6,name:"Ефимов Даниил"},{id:7,name:"Жуков Кирилл"},{id:8,name:"Козлов Артем"},{id:9,name:"Комилов Амирхан"},{id:10,name:"Литвинов Максим"},{id:11,name:"Лобачевский Вадим"},{id:12,name:"Луганский Семён"},{id:13,name:"Молчанов Дмитрий"},{id:14,name:"Нужный Роман"},{id:15,name:"Остроух Ярослав"},{id:16,name:"Подрезов Сергей"},{id:17,name:"Пыжов Илья"},{id:18,name:"Расулов Амин"},{id:19,name:"Селявка Александр"},{id:20,name:"Тен Владимир"},{id:21,name:"Фоменко Дмитрий"},{id:22,name:"Шабалин Артём"},{id:23,name:"Шарифов Тимур"},{id:24,name:"Шкабарня Александра"}],e=["Математика","Физика","Литература","Русский","История","Химия","Информатика","Иностранный"];function f(a){return({})[a]||null}function g(a){}function h(){return[].sort()}function i(a,f){let g,h=(g=`${a}-${String(f).padStart(2,"0")}`,[].filter(a=>a.startsWith(g)).sort()),i={},j={};e.forEach(a=>j[a]=0);let k={};for(let a of(d.forEach(a=>{k[a.id]={},e.forEach(b=>{k[a.id][b]={total:0,excused:0}})}),h)){let b=i[a];if(b){for(let a of b.pairs)if(a.subject)for(let b of(j[a.subject]=(j[a.subject]||0)+2,d)){let c=a.attendance[b.id]||"";("Н"===c||"У"===c)&&(k[b.id][a.subject].total+=2,"У"===c&&(k[b.id][a.subject].excused+=2))}}}let l=Object.values(j).reduce((a,b)=>a+b,0),m=d.map(a=>{let b={},c=0,d=0;e.forEach(e=>{let f=k[a.id][e].total;b[e]=f,c+=f,d+=k[a.id][e].excused});let f=l>0?`${Math.round(c/l*100)}%`:"0%",g=l>0?`${Math.round((c-d)/l*100)}%`:"0%";return{studentId:a.id,studentName:a.name,bySubject:b,total:c,excused:d,totalPercent:f,unexcusedPercent:g}});return{month:["","январь","февраль","март","апрель","май","июнь","июль","август","сентябрь","октябрь","ноябрь","декабрь"][f],year:`${a}-${a+1}`,group:b,curator:c,subjects:[...e],subjectHours:j,totalHours:l,rows:m}}function j(a){return[["№","ФИО студента",...a.subjects,"ИТОГО","Из них по уважит.","% пропусков","% неуважит. проп."],["","Кол. часов",...a.subjects.map(b=>String(a.subjectHours[b])),String(a.totalHours),"","",""],...a.rows.map((b,c)=>[String(c+1),b.studentName,...a.subjects.map(a=>String(b.bySubject[a]||"")),String(b.total),String(b.excused),b.totalPercent,b.unexcusedPercent])].map(a=>a.join(",")).join("\n")}a.s(["CURATOR",0,c,"GROUP_NAME",0,b,"HOURS_PER_PAIR",0,2,"STUDENTS",0,d,"SUBJECTS",0,e],2759),a.s(["exportReportCSV",()=>j,"generateMonthReport",()=>i,"getDayAttendance",()=>f,"getFilledDates",()=>h,"saveDayAttendance",()=>g],76808)},40777,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(2759),e=a.i(76808),f=a.i(71106),g=a.i(38246);function h(a){return Array.from({length:a},(a,b)=>({pairNumber:b+1,subject:"",attendance:{}}))}function i({status:a,onClick:c}){return"Н"===a?(0,b.jsx)("button",{onClick:c,className:"w-12 h-12 rounded-xl bg-red-500 text-white font-bold text-lg flex items-center justify-center active:scale-95 transition-transform shadow-sm",children:"Н"}):"У"===a?(0,b.jsx)("button",{onClick:c,className:"w-12 h-12 rounded-xl bg-amber-400 text-white font-bold text-lg flex items-center justify-center active:scale-95 transition-transform shadow-sm",children:"У"}):(0,b.jsx)("button",{onClick:c,className:"w-12 h-12 rounded-xl bg-emerald-100 text-emerald-600 font-bold text-lg flex items-center justify-center active:scale-95 transition-transform border border-emerald-200",children:"+"})}function j(){let a,j,[k,l]=(0,c.useState)((a=new Date,`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}-${String(a.getDate()).padStart(2,"0")}`)),[m,n]=(0,c.useState)(4),[o,p]=(0,c.useState)(h(4)),[q,r]=(0,c.useState)(0),[s,t]=(0,c.useState)(!1),[u,v]=(0,c.useState)(!1);(0,c.useEffect)(()=>{let a=(0,e.getDayAttendance)(k);a?(p(a.pairs),n(a.pairs.length)):(p(h(4)),n(4)),r(0),t(!1),v(!0)},[k]);let w=(0,c.useCallback)(a=>{p(b=>{let c=[...b],d={...c[q]},e={...d.attendance},f=e[a]||"";return""===f?e[a]="Н":"Н"===f?e[a]="У":delete e[a],d.attendance=e,c[q]=d,c}),t(!1)},[q]),x=(0,c.useCallback)(a=>{p(b=>{let c=[...b];return c[q]={...c[q],subject:a},c}),t(!1)},[q]),[y,z]=(0,c.useState)(!1),[A,B]=(0,c.useState)(""),C=(0,c.useCallback)(async()=>{let a={date:k,pairs:o.slice(0,m)};(0,e.saveDayAttendance)(a),t(!0);let b=(0,f.getSyncSettings)();b?.scriptUrl&&(z(!0),B((await (0,f.syncSaveAttendance)(a)).message),z(!1),setTimeout(()=>B(""),3e3)),setTimeout(()=>t(!1),2e3)},[k,o,m]),D=(0,c.useCallback)(()=>{p(a=>{let b=[...a];return b[q]={...b[q],attendance:{}},b}),t(!1)},[q]),E=Object.values(o[q]?.attendance||{}).filter(Boolean).length;return u?(0,b.jsxs)("div",{className:"max-w-lg mx-auto pb-24",children:[(0,b.jsx)("header",{className:"bg-blue-500 text-white px-4 py-3 sticky top-0 z-50 shadow-md",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(g.default,{href:"/settings",className:"text-sm bg-white/20 w-8 h-8 rounded-lg flex items-center justify-center",children:(0,b.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,b.jsx)("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"}),(0,b.jsx)("circle",{cx:"12",cy:"12",r:"3"})]})}),(0,b.jsx)("h1",{className:"text-lg font-bold",children:"Журнал СИС-12"}),(0,b.jsx)(g.default,{href:"/report",className:"text-sm bg-white/20 px-3 py-1.5 rounded-lg hover:bg-white/30 transition-colors",children:"Отчёт"})]})}),(0,b.jsx)("div",{className:"px-4 py-3 bg-white border-b border-gray-100",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("input",{type:"date",value:k,onChange:a=>l(a.target.value),className:"flex-1 border border-gray-200 rounded-xl px-4 py-2.5 text-base bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-300"}),(0,b.jsx)("span",{className:"text-sm text-gray-500 font-medium min-w-[80px] text-right",children:(j=new Date(k+"T00:00:00"),`${["Вс","Пн","Вт","Ср","Чт","Пт","Сб"][j.getDay()]}, ${j.getDate()} ${["янв","фев","мар","апр","май","июн","июл","авг","сен","окт","ноя","дек"][j.getMonth()]}`)})]})}),(0,b.jsxs)("div",{className:"px-4 py-2 bg-white border-b border-gray-100",children:[(0,b.jsx)("div",{className:"flex gap-2",children:Array.from({length:m},(a,c)=>{let d=Object.values(o[c]?.attendance||{}).filter(Boolean).length;return(0,b.jsxs)("button",{onClick:()=>r(c),className:`flex-1 py-2 rounded-xl text-sm font-medium transition-all relative ${q===c?"bg-blue-500 text-white shadow-md":"bg-gray-100 text-gray-600"}`,children:["Пара ",c+1,d>0&&(0,b.jsx)("span",{className:`absolute -top-1.5 -right-1 min-w-5 h-5 px-1 rounded-full text-xs flex items-center justify-center font-bold ${q===c?"bg-red-500 text-white":"bg-red-100 text-red-600"}`,children:d})]},c)})}),(0,b.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,b.jsx)("span",{className:"text-xs text-gray-400",children:"Кол-во пар:"}),[2,3,4].map(a=>(0,b.jsx)("button",{onClick:()=>{n(a),q>=a&&r(a-1),p(b=>b.length>=a?b:[...b,...h(a-b.length)])},className:`w-8 h-7 rounded-lg text-xs font-medium ${m===a?"bg-blue-100 text-blue-700 border border-blue-300":"bg-gray-50 text-gray-400 border border-gray-200"}`,children:a},a))]})]}),(0,b.jsx)("div",{className:"px-4 py-2 bg-white border-b border-gray-100",children:(0,b.jsxs)("select",{value:o[q]?.subject||"",onChange:a=>x(a.target.value),className:"w-full border border-gray-200 rounded-xl px-4 py-2.5 text-base bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-300",children:[(0,b.jsx)("option",{value:"",children:"-- Предмет --"}),d.SUBJECTS.map(a=>(0,b.jsx)("option",{value:a,children:a},a))]})}),(0,b.jsxs)("div",{className:"px-4 py-2 bg-gray-50 flex items-center justify-between border-b border-gray-100",children:[(0,b.jsxs)("span",{className:"text-xs text-gray-500",children:["Нет: ",(0,b.jsx)("span",{className:"font-bold text-gray-700",children:E})," / ",d.STUDENTS.length]}),E>0&&(0,b.jsx)("button",{onClick:D,className:"text-xs text-blue-500 font-medium",children:"Сбросить"})]}),(0,b.jsxs)("div",{className:"px-4 py-1.5 bg-gray-50 flex gap-4 text-xs text-gray-400 border-b border-gray-100",children:[(0,b.jsxs)("span",{className:"flex items-center gap-1",children:[(0,b.jsx)("span",{className:"w-3 h-3 rounded bg-emerald-100 border border-emerald-200 inline-block"})," Есть"]}),(0,b.jsxs)("span",{className:"flex items-center gap-1",children:[(0,b.jsx)("span",{className:"w-3 h-3 rounded bg-red-500 inline-block"})," Н"]}),(0,b.jsxs)("span",{className:"flex items-center gap-1",children:[(0,b.jsx)("span",{className:"w-3 h-3 rounded bg-amber-400 inline-block"})," У"]})]}),(0,b.jsx)("div",{className:"divide-y divide-gray-100",children:d.STUDENTS.map(a=>{let c=o[q]?.attendance[a.id]||"";return(0,b.jsxs)("div",{className:`flex items-center px-4 py-2.5 gap-3 transition-colors ${"Н"===c?"bg-red-50":"У"===c?"bg-amber-50":"bg-white"}`,children:[(0,b.jsx)("span",{className:"text-xs text-gray-400 w-5 text-right shrink-0",children:a.id}),(0,b.jsx)("span",{className:"flex-1 text-sm font-medium truncate",children:a.name}),(0,b.jsx)(i,{status:c,onClick:()=>w(a.id)})]},a.id)})}),(0,b.jsx)("div",{className:"fixed bottom-0 left-0 right-0 p-4 bg-white/90 backdrop-blur-sm border-t shadow-lg z-50",children:(0,b.jsxs)("div",{className:"max-w-lg mx-auto",children:[A&&(0,b.jsx)("p",{className:"text-xs text-center text-gray-500 mb-1",children:A}),(0,b.jsx)("button",{onClick:C,disabled:y,className:`w-full py-3.5 rounded-2xl font-bold text-lg transition-all active:scale-[0.98] shadow-md ${s?"bg-emerald-500 text-white":y?"bg-gray-400 text-white":"bg-blue-500 text-white"}`,children:y?"Синхронизация...":s?"Сохранено!":"Сохранить"})]})})]}):(0,b.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,b.jsx)("div",{className:"text-gray-400 text-lg",children:"Загрузка..."})})}a.s(["default",()=>j])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__b20d922d._.js.map